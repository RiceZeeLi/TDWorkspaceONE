# è£½ä½œ macOS å…­ä»£åŒå ‚å®‰è£å§†æŒ‡ç¢Ÿçš„ç¨‹åº

v2.0 - æ”¹ä»¥ã€Œç°¡æ˜“ç¨‹åºã€ã€ã€Œé€²éšæ‡‰ç”¨ã€åŠã€Œæ·±å…¥è§£æã€ä¾†èªªæ˜ã€‚çŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ã€‚

## æ–‡ä»¶ç›®æ¨™

Apple æä¾›å¾ˆæ–¹ä¾¿çš„ã€Œ[é–‹æ©Ÿçµ„åˆéµ](https://support.apple.com/zh-tw/102603)ã€ å¯ä»¥é€éç¶²è·¯å®‰è£é©ç”¨æ–¼ç‰¹å®šçš„ MacBook æœ€æ–°æˆ–æœ€èˆŠç‰ˆæœ¬çš„ macOSã€‚

å¯æƒœçš„æ˜¯ï¼Œæˆ‘å‰›å¥½é‡åˆ°ä¸€å° MacBook Pro åœ¨å®‰è£éç¨‹ä¸­ä¸€ç›´éƒ½å¡é—œåœ¨ 5101F çš„éŒ¯èª¤ã€‚åƒè€ƒäº†å¦‚ä¸‹éƒ½æ²’èƒ½è§£æ±ºé€™å€‹å•é¡Œï¼Œæ–¼æ±ºå®šè£½ä½œä¸€å€‹ macOS å®‰è£å§†æŒ‡ç¢Ÿä¾†è©¦è©¦æ˜¯å¦èƒ½è·³éé€™å€‹å•é¡Œã€‚
- [å¦‚æœ Mac æ²’æœ‰é †æš¢åœ°å®Œæˆå•Ÿå‹• - Apple æ”¯æ´ (å°ç£)](https://support.apple.com/zh-tw/HT204156)
- [Fix MacBook Error 5101F With This Quick Guide - AppleToolBox](https://appletoolbox.com/fix-macbook-error-5101f/)
- [GitHub - MuertoGB/MacBRTool: ğŸ’» MacBRTool is used to update Mac BootROM firmware in EFI mode, adding APFS support.](https://github.com/MuertoGB/MacBRTool)

æˆ‘æ‰¾åˆ°äº†ä¸‰å€‹ Cruzer Blade 16G, ä¸€å€‹ PNY DUAL 128G å§†æŒ‡ç¢Ÿ, ä¹Ÿä¸‹è¼‰äº†å…­å€‹ç‰ˆæœ¬çš„ macOS (High Sierra, Mojave, Catalina, Big Sur, Monterey, Ventura)ã€‚åœ¨æ¸¬è©¦éã€Œ[How to create a macOS 13 Ventura installer on a USB drive](https://www.idownloadblog.com/2022/06/10/how-to-create-bootable-usb-installer-macos-ventura/) ã€ä¹‹å¾Œæˆ‘æƒ³åˆ°æ˜¯å¦å¯ä»¥å°‡å…­å€‹ç‰ˆæœ¬çš„ macOS éƒ½æ”¾åœ¨åŒä¸€å€‹å®‰è£å§†æŒ‡ç¢Ÿï¼Ÿ

è‹¥å¯ä»¥ï¼Œé‚£æˆ‘å°±å¯ä»¥ä¸€æ¬¡åˆ°ä½å®‰è£æˆ‘è¦çš„ macOS ç‰ˆæœ¬ã€‚è€Œä¸”æ”¾ä¸€äº›å·¥å…·åŠæª”æ¡ˆåœ¨å‰©ä¸‹çš„å§†æŒ‡ç¢Ÿç©ºé–“ã€‚æœ¬ä»½æ–‡ä»¶æä¾›ç›¸é—œçš„å¯¦ä½œç¨‹åºåŠå¤–æ®¼è…³æœ¬(Shell Script)çµ¦æœ‰ç›¸åŒéœ€æ±‚çš„æœ‹å‹åƒè€ƒä½¿ç”¨ã€‚

## å…§å®¹æ‘˜è¦

å¦‚ä¸‹ç‚ºç°¡æ˜“ç¨‹åºçš„æ‘˜è¦ï¼š
1. å°‡å§†æŒ‡ç¢Ÿåˆ†å‰²æˆå…­åŠ ä¸€å€‹åˆ†å‰²å€
1. è£½ä½œ macOS å„ç‰ˆæœ¬çš„å®‰è£å·å†Š
1. é€²è¡Œå®‰è£

## æº–å‚™å·¥ä½œ

### æ‰€éœ€è¨­å‚™

- ä¸€å€‹ 128GB çš„å§†æŒ‡ç¢Ÿ
- ä¸€å° MacBook (Intel)ï¼Œå› ç‚ºéœ€è¦ä¸‹è¼‰èˆŠç‰ˆæœ¬çš„ macOS æ‰€ä»¥ç”¨ Intel ç‰ˆæœ¬çš„ MacBook ä¾†ä¸‹è¼‰ã€‚

### ä¸‹è¼‰æª”æ¡ˆ

- é€é Goolge æƒå°‹ã€ŒDownload macOS {Version}ã€ï¼Œåˆ†åˆ¥ä¸‹è¼‰å…­å€‹ç‰ˆæœ¬çš„ macOS (High Sierra, Mojave, Catalina, Big Sur, Monterey, Ventura) 

### å®‰è£å·¥å…·

- æœ¬æ–‡ä¸»è¦ä½¿ç”¨å¤–æ®¼è…³æœ¬ä¾†å¯¦ç¾ã€‚è«‹ä¸‹è¼‰ Pod ç›®éŒ„ä¸­çš„ç›¸é—œæª”æ¡ˆåˆ°æœ¬åœ°çš„ Pod ç›®éŒ„ä¸­ã€‚åœ¨ Pod ç›®éŒ„ä¸­çš„ bin ç›®éŒ„æœ‰æœ¬æ–‡æ‰€éœ€çš„ç›¸é—œå¤–æ®¼è…³æœ¬æª”æ¡ˆã€‚åœ¨ã€Œæ·±å…¥è§£æã€ä¸€ç¯€ä¸­æœƒè§£æä¸€äº›å¤–æ®¼è…³æœ¬çš„æŠ€å·§ã€‚ etc ç›®éŒ„å‰‡æœ‰é…ç½®æª”æ¡ˆã€‚ 
  
- æœ¬æ–‡ä¸­å¤–æ®¼è…³æœ¬æœƒé€éå¦‚ä¸‹å…©å€‹æ–¹å¼ä¾†ä½¿ç”¨ï¼Œåœ¨æ­¤å…ˆè¡Œè£œå……èªªæ˜ï¼š

ä»¥å¤–æ®¼è…³æœ¬çš„è¼¸å‡ºåšç‚ºæŒ‡ä»¤`sh`çš„è¼¸å…¥ä¸”é¡¯ç¤ºæ‰€åŸ·è¡Œçš„æŒ‡ä»¤(`-x`)ï¼š
```shell
... | sh -x
```
ä»¥å¤–æ®¼è…³æœ¬çš„è¼¸å‡ºåšç‚ºæŒ‡ä»¤`sh`çš„è¼¸å…¥ä¸”é¡¯ç¤ºæ‰€åŸ·è¡Œçš„æŒ‡ä»¤(`-x`)ï¼Œä¸¦ä»¥`time`é‡æ¸¬å…¨éƒ¨çš„åŸ·è¡Œæ™‚é–“ï¼š
```shell
... | time sh -x
```

- è‹¥ä¸æƒ³å€‹åˆ¥ä¸‹è¼‰æ‰€éœ€æª”æ¡ˆï¼Œå¦‚ä¸‹ç‚ºå¿«é€Ÿè¤‡è£½æ•´å€‹ TDWorkspaceONE å„²å­˜åº«åˆ°ç›®å‰ç›®éŒ„ä¸­ TDWorkspaceONE å­ç›®éŒ„çš„æŒ‡ä»¤ï¼š

```shell
gh repo clone RiceZeeLi/TDWorkspaceONE
```

```
æ­£è¤‡è£½åˆ° 'TDWorkspaceONE'...
remote: Enumerating objects: 148, done.
remote: Counting objects: 100% (148/148), done.
remote: Compressing objects: 100% (107/107), done.
remote: Total 148 (delta 75), reused 104 (delta 39), pack-reused 0
æ¥æ”¶ç‰©ä»¶ä¸­: 100% (148/148), 1.52 MiB | 1.48 MiB/s, å®Œæˆ.
è™•ç† delta ä¸­: 100% (75/75), å®Œæˆ.
```

- è‹¥æ›¾ç¶“ä¸‹è¼‰é TDWorkspaceONE å„²å­˜åº«, å‰‡å¯ä»¥åœ¨ TDWorkspaceONE ç›®éŒ„ä¸­é€éåŒæ­¥çš„æŒ‡ä»¤æ›´æ–°ã€‚

```
gh repo sync
```

``` text
âœ“ Synced the "main" branch from RiceZeeLi/TDWorkspaceONE to local repository
```
- æœ¬æ–‡ä¸­çš„æŒ‡ä»¤åŸ·è¡Œï¼Œéƒ½å‡è¨­æ˜¯åœ¨ Pod çš„ç›®éŒ„ä¸­ã€‚

### æ¸›å°‘å¹²æ“¾

- åœæ­¢ Spotlight çš„æœå‹™ã€‚

å› ç‚ºåœ¨è£½ä½œå®‰è£å§†æŒ‡ç¢Ÿçš„éç¨‹æ™‚é–“é•·ä¸”æœƒæ›è¼‰åŠå¸è¼‰å·å†Šï¼ŒæœŸé–“ Spotlight å¯èƒ½æœƒä½”ä½å·å†Šé€²è¡Œç´¢å¼•è€Œç„¡æ³•é †åˆ©å¸è¼‰å·å†Šã€‚ç‚ºäº†æ¸›å°‘å¯èƒ½çš„å¹²æ“¾ï¼Œ è«‹åƒè€ƒé‡å°æ‚¨çš„ macOS ç‰ˆæœ¬æ‰€éœ€çš„ç¨‹åºä¾†åœæ­¢ Spotlight çš„æœå‹™ï¼Œå¦‚ã€Œ [MacOS Sierra: Enable/Disable Spotlight Indexing - Technipages](https://www.technipages.com/macos-sierra-enable-disable-spotlight/) ã€ä¸­çš„ã€ŒOption 2 â€“ Completely Disable Spotlight Indexingã€ã€‚

## ç°¡æ˜“ç¨‹åº

æ•´å€‹ç¨‹åºé€é PartitionUSBFlashDrive åŠ MakeMacOSInstallers é€™å…©å€‹å¤–æ®¼è…³æœ¬ä¾†å®Œæˆã€‚é…ç½®æª”æ¡ˆå‰‡ç‚º USBPartitionTable.txt ã€‚ 

### å°‡å§†æŒ‡ç¢Ÿåˆ†å‰²æˆå…­åŠ ä¸€å€‹åˆ†å‰²å€

#### ç¢ºèªå§†æŒ‡ç¢Ÿçš„è£ç½®æª”æ¡ˆ

é€é`diskutil list`æŒ‡ä»¤æˆ–ã€Œç£ç¢Ÿå·¥å…·ç¨‹å¼ã€ä¾†ç¢ºèªå§†æŒ‡ç¢Ÿæ˜¯ç”¨é‚£ä¸€å€‹è£ç½®æª”æ¡ˆï¼Œæœ¬æ–‡ä»¥ disk2 ç‚ºä¾‹ã€‚

```shell
diskutil list
```
```text
...ï¼ˆç•¥ã€‚è«‹åœ¨å§†æŒ‡ç¢Ÿæ¥ä¸Šé›»è…¦å‰å¾Œåˆ†åˆ¥åŸ·è¡Œ diskutil list ç„¶å¾Œæ¯”è¼ƒä¸€ä¸‹è¼¸å‡ºçš„å·®åˆ¥ã€‚ï¼‰
```

#### æª¢è¦–åˆ†å‰²é…ç½®æª”æ¡ˆ
```shell
more etc/USBPartitionTable.txt
```
```text
High Sierra,8GB
Mojave,8GB
Catalina,10GB
Big Sur,14GB
Monterey,16GB
Ventura,16GB
Pod,R
```
#### é€²è¡Œåˆ†å‰²
```shell
bin/PartitionUSBFlashDrive disk2 etc/USBPartitionTable.txt | time sh -x
```
```text
+ diskutil partitionDisk disk2 7 JHFS+ 'For High Sierra' 8GB JHFS+ 'For Mojave' 8GB JHFS+ 'For Catalina' 10GB JHFS+ 'For Big Sur' 14GB JHFS+ 'For Monterey' 16GB JHFS+ 'For Ventura' 16GB JHFS+ Pod R
Started partitioning on disk2
Unmounting disk
Creating the partition map
Waiting for partitions to activate
Formatting disk2s2 as Mac OS Extended (Journaled) with name For High Sierra
Initialized /dev/rdisk2s2 as a 7 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Formatting disk2s3 as Mac OS Extended (Journaled) with name For Mojave
Initialized /dev/rdisk2s3 as a 7 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Formatting disk2s4 as Mac OS Extended (Journaled) with name For Catalina
Initialized /dev/rdisk2s4 as a 9 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Formatting disk2s5 as Mac OS Extended (Journaled) with name For Big Sur
Initialized /dev/rdisk2s5 as a 13 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Formatting disk2s6 as Mac OS Extended (Journaled) with name For Monterey
Initialized /dev/rdisk2s6 as a 15 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Formatting disk2s7 as Mac OS Extended (Journaled) with name For Ventura
Initialized /dev/rdisk2s7 as a 15 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Formatting disk2s8 as Mac OS Extended (Journaled) with name Pod
Initialized /dev/rdisk2s8 as a 48 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Finished partitioning on disk2
/dev/disk2 (external, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                        *124.0 GB   disk2
   1:                        EFI EFI                     209.7 MB   disk2s1
   2:                  Apple_HFS For High Sierra         7.9 GB     disk2s2
   3:                  Apple_HFS For Mojave              7.9 GB     disk2s3
   4:                  Apple_HFS For Catalina            9.9 GB     disk2s4
   5:                  Apple_HFS For Big Sur             13.9 GB    disk2s5
   6:                  Apple_HFS For Monterey            15.9 GB    disk2s6
   7:                  Apple_HFS For Ventura             15.9 GB    disk2s7
   8:                  Apple_HFS Pod                     51.7 GB    disk2s8
sh -x  0.34s user 0.22s system 0% cpu 4:54.70 total
```

### è£½ä½œ macOS å„ç‰ˆæœ¬çš„å®‰è£å·å†Š

#### è£½ä½œå®‰è£å·å†Š

```shell
bin/MakeMacOSInstallers etc/USBPartitionTable.txt | time sh -x
```
```text
+ '/Applications/Install macOS High Sierra.app/Contents/Resources/createinstallmedia' --volume '/Volumes/For High Sierra' --nointeraction
Erasing Disk: 0%... 10%... 20%... 30%...100%...
Copying installer files to disk...
Copy complete.
Making disk bootable...
Copying boot files...
Copy complete.
Done.
+ touch '/Volumes/Install macOS High Sierra/.metadata_never_index'
+ sleep 60
+ df
+ grep 'Shared Support'
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil list external virtual
+ grep '(disk image)'
+ read x1 z
+ diskutil unmount force '/Volumes/Install macOS High Sierra'
Volume Install macOS High Sierra on disk2s2 force-unmounted
+ '/Applications/Install macOS Mojave.app/Contents/Resources/createinstallmedia' --volume '/Volumes/For Mojave' --nointeraction
Erasing disk: 0%... 10%... 20%... 30%... 100%
Copying to disk: 0%... 10%... 20%... 30%... 40%... 50%... 60%... 70%... 80%... 90%... 100%
Making disk bootable...
Copying boot files...
Install media now available at "/Volumes/Install macOS Mojave"
+ touch '/Volumes/Install macOS Mojave/.metadata_never_index'
+ sleep 60
+ df
+ grep 'Shared Support'
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil list external virtual
+ grep '(disk image)'
+ read x1 z
+ diskutil unmount force '/Volumes/Install macOS Mojave'
Volume Install macOS Mojave on disk2s3 force-unmounted
+ '/Applications/Install macOS Catalina.app/Contents/Resources/createinstallmedia' --volume '/Volumes/For Catalina' --nointeraction
Erasing disk: 0%... 10%... 20%... 30%... 100%
Copying to disk: 0%... 10%... 20%... 30%... 40%... 50%... 60%... 70%... 80%... 90%... 100%
Making disk bootable...
Copying boot files...
Install media now available at "/Volumes/Install macOS Catalina"
+ touch '/Volumes/Install macOS Catalina/.metadata_never_index'
+ sleep 60
+ df
+ grep 'Shared Support'
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil list external virtual
+ grep '(disk image)'
+ read x1 z
+ diskutil unmount force '/Volumes/Install macOS Catalina'
Volume Install macOS Catalina on disk2s4 force-unmounted
+ '/Applications/Install macOS Big Sur.app/Contents/Resources/createinstallmedia' --volume '/Volumes/For Big Sur' --nointeraction
Erasing disk: 0%... 10%... 20%... 30%... 100%
Copying to disk: 0%... 10%... 20%... 30%... 40%... 50%... 60%... 70%... 80%... 90%... 100%
Making disk bootable...
Install media now available at "/Volumes/Install macOS Big Sur"
+ touch '/Volumes/Install macOS Big Sur/.metadata_never_index'
+ sleep 60
+ df
+ grep 'Shared Support'
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil unmount force '/Volumes/Shared Support'
Volume Shared Support on disk3s2 force-unmounted
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil unmount force '/Volumes/Shared Support 1'
Volume Shared Support on disk4s2 force-unmounted
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil list external virtual
+ grep '(disk image)'
+ read x1 z
+ diskutil unmount force '/Volumes/Install macOS Big Sur'
Volume Install macOS Big Sur on disk2s5 force-unmounted
+ '/Applications/Install macOS Monterey.app/Contents/Resources/createinstallmedia' --volume '/Volumes/For Monterey' --nointeraction
Erasing disk: 0%... 10%... 20%... 30%... 100%
Making disk bootable...
Copying to disk: 0%... 10%... 20%... 30%... 40%... 50%... 60%... 70%... 80%... 90%... 100%
Install media now available at "/Volumes/Install macOS Monterey"
+ touch '/Volumes/Install macOS Monterey/.metadata_never_index'
+ sleep 60
+ df
+ grep 'Shared Support'
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil unmount force '/Volumes/Shared Support'
Volume Shared Support on disk5s2 force-unmounted
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil list external virtual
+ grep '(disk image)'
+ read x1 z
+ diskutil unmount force '/Volumes/Install macOS Monterey'
Volume Install macOS Monterey on disk2s6 force-unmounted
+ '/Applications/Install macOS Ventura.app/Contents/Resources/createinstallmedia' --volume '/Volumes/For Ventura' --nointeraction
Erasing disk: 0%... 10%... 20%... 30%... 100%
Copying essential files...
Copying the macOS RecoveryOS...
Making disk bootable...
Copying to disk: 0%... 10%... 20%... 30%... 40%... 50%... 60%... 70%... 80%... 90%... 100%
Install media now available at "/Volumes/Install macOS Ventura"
+ touch '/Volumes/Install macOS Ventura/.metadata_never_index'
+ sleep 60
+ df
+ grep 'Shared Support'
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil unmount force '/Volumes/Shared Support'
Volume Shared Support on disk6s2 force-unmounted
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil list external virtual
+ grep '(disk image)'
+ read x1 z
+ diskutil unmount force '/Volumes/Install macOS Ventura'
Volume Install macOS Ventura on disk2s7 force-unmounted
sh -x  107.76s user 86.19s system 2% cpu 2:08:08.90 total
```

å¦‚ä¸Šå¯ä»¥çœ‹åˆ°åŸ·è¡Œæ™‚é–“ç‚º 2:08:08.90 ï¼Œ2 å°æ™‚ 8 åˆ†é˜ 8.90 ç§’ã€‚

å¦‚ä¸‹å‰‡æ˜¯é€éã€Œç£ç¢Ÿå·¥å…·ç¨‹å¼ã€çœ‹åˆ°çš„æˆæœï¼š
![All in ONE Done](All%20in%20ONE%20macOS%20Installer-Done.png "All in ONE Done")

### é€²è¡Œå®‰è£

å°‡å®‰è£å§†æŒ‡ç¢Ÿæ¥ä¸Šé›»è…¦ï¼Œå£“ä½ option éµï¼Œç„¶å¾ŒæŒ‰ä¸€ä¸‹é›»æºéµè®“ MacBook é–‹æ©Ÿã€‚è‹¥æ‚¨å¯ä»¥é †åˆ©çœ‹åˆ°å¦‚ä¸‹é‚£å°±ã€Œè®šğŸ‘ã€å•¦ï¼

![All in ONE boot](All%20in%20ONE%20macOS%20Installer-Boot.png "All in ONE boot")

å®‰è£å¾Œæª¢è¦–ç¡¬é«”ç‰ˆæœ¬è³‡è¨Š

```shell
system_profiler SPHardwareDataType
```

è¼¸å‡ºç¯„ä¾‹ä¸€ï¼š

```text
Hardware:

    Hardware Overview:
      Model Name: MacBook Pro
      Model Identifier: MacBookPro13,2
      ...
```

è¼¸å‡ºç¯„ä¾‹äºŒï¼š

```text
Hardware:

    Hardware Overview:

      Model Name: MacBook Pro
      Model Identifier: MacBookPro14,2
      ...
```

å®‰è£å¾Œæª¢è¦–ä½œæ¥­ç³»çµ±ç‰ˆæœ¬è³‡è¨Š

```shell
sw_vers
```
```text
ProductName:		macOS
ProductVersion:		13.6
BuildVersion:		22G120
```

## é€²éšæ‡‰ç”¨

å¦‚ä¸‹çš„ç¨‹åºå°‡åªè£½ä½œ macOS High Sierra çš„å®‰è£å·å†Šã€‚

### å°‡å§†æŒ‡ç¢Ÿåˆ†å‰²æˆä¸€åŠ ä¸€å€‹åˆ†å‰²å€

#### æª¢è¦–åˆ†å‰²é…ç½®æª”æ¡ˆ
```shell
more etc/USBPartitionTable-High\ Sierra.txt
```
```text
High Sierra,8GB
Pod,R
```
#### é€²è¡Œåˆ†å‰²
```shell
bin/PartitionUSBFlashDrive disk2 etc/USBPartitionTable-High\ Sierra.txt | sh -x
```
```text
+ diskutil partitionDisk disk2 2 JHFS+ 'For High Sierra' 8GB JHFS+ Pod R
Started partitioning on disk2
Unmounting disk
Creating the partition map
Waiting for partitions to activate
Formatting disk2s2 as Mac OS Extended (Journaled) with name For High Sierra
Initialized /dev/rdisk2s2 as a 7 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Formatting disk2s3 as Mac OS Extended (Journaled) with name Pod
Initialized /dev/rdisk2s3 as a 7 GB case-insensitive HFS Plus volume with a 8192k journal
Mounting disk
Finished partitioning on disk2
/dev/disk2 (external, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                        *16.0 GB    disk2
   1:                        EFI EFI                     209.7 MB   disk2s1
   2:                  Apple_HFS For High Sierra         7.9 GB     disk2s2
   3:                  Apple_HFS Pod                     7.7 GB     disk2s3
```
### è£½ä½œ macOS High Sierra çš„å®‰è£å·å†Š

#### è£½ä½œå®‰è£å·å†Š

```shell
bin/MakeMacOSInstallers etc/USBPartitionTable-High\ Sierra.txt | time sh -x
```
```text
+ '/Applications/Install macOS High Sierra.app/Contents/Resources/createinstallmedia' --volume '/Volumes/For High Sierra' --nointeraction
Erasing Disk: 0%... 10%... 20%... 30%...100%...
Copying installer files to disk...
Copy complete.
Making disk bootable...
Copying boot files...
Copy complete.
Done.
+ touch '/Volumes/Install macOS High Sierra/.metadata_never_index'
+ sync
+ sleep 60
+ df
+ grep 'Shared Support'
+ read x1 x2 x3 x4 x5 x6 x7 x8 x9
+ diskutil list external virtual
+ grep '(disk image)'
+ read x1 z
+ diskutil unmount force '/Volumes/Install macOS High Sierra'
Volume Install macOS High Sierra on disk2s2 force-unmounted
sh -x  0.25s user 4.77s system 0% cpu 24:39.79 total
```

### çªç™¼å¥‡æƒ³

è‹¥æ‚¨çš„é…ç½®æª”æ¡ˆæ˜¯å¦‚ä¸‹ï¼Œå‰‡åŸ·è¡Œ`PartitionUSBFlashDrive`å¾Œå°±æœƒåªæœ‰ä¸€å€‹ Pod çš„åˆ†å‰²å€ã€‚

```shell
more etc/USBPartitionTable-Pod.txt
```
```text
Pod,R
```
```shell
bin/PartitionUSBFlashDrive disk2 etc/USBPartitionTable-Pod.txt | sh -x
```
```
...ï¼ˆç•¥ï¼‰
```

## æ·±å…¥è§£æ

### bin/MakeMacOSInstallers

æ­¤ä¸€å¤–æ®¼è…³æœ¬ç”¨ä¾†å°‡å„å€‹ç‰ˆæœ¬çš„ macOS å®‰è£æª”å®‰è£è‡³å§†æŒ‡ç¢Ÿå°æ‡‰é ç•™çš„å·å†Šã€‚ç”±æ–¼æœƒé‡æ–°æ ¼å¼åŒ–å·å†Šï¼Œå› æ­¤æ¡ç”¨ç”¢ç”Ÿå¤–æ®¼è…³æœ¬çš„æ–¹å¼ï¼Œåœ¨æª¢è¦–ç¢ºèªå¤–æ®¼è…³æœ¬å¾Œå†ç”¨ç®¡é“`|`çš„æ–¹å¼äº¤ç”±`sh`ã€ `sh -x` æˆ– `time sh -x` ä¾†åŸ·è¡Œã€‚

å¦‚ä¸‹æŒ‡ä»¤çš„ç›®çš„å¦‚`#`ä¹‹å¾Œæ–‡å­—æ‰€åŠ è¨»ï¼Œå› ç‚ºåˆ†å‰²é…ç½®æª”æ¡ˆæ˜¯ç”¨`,`ä¾†åˆ†éš”æ¬„ä½ï¼Œè€Œä¸æ˜¯ä¸€èˆ¬çš„ç©ºç™½å­—å…ƒï¼Œå¦‚æ­¤æ¬„ä½ä¸­çš„è³‡æ–™å¯ä»¥ç”¨ç©ºç™½å­—å…ƒï¼š
```shell
XFS=$IFS # ä¿ç•™è¼¸å…¥æ¬„ä½åˆ†éš”ç¬¦(Input Field Separator)
IFS="," # è¨­å®šè¼¸å…¥æ¬„ä½åˆ†éš”ç¬¦ç‚ºé€—è™Ÿ
IFS=$XFS # é‚„åŸè¼¸å…¥æ¬„ä½åˆ†éš”ç¬¦
```

å¦‚ä¸‹æŒ‡ä»¤æ˜¯ç‚ºäº†è®€å–`df`è¼¸å‡ºå…§å®¹çš„ç¬¬ 9 å€‹æ¬„ä½ï¼Œå°‡å…¶å€¼æŒ‡æ´¾åˆ° `x9`ã€‚
```shell
read x1 x2 x3 x4 x5 x6 x7 x8 x9
```

å¦‚ä¸‹æŒ‡ä»¤ï¼Œå°‡ `cat "$1"` çš„åŸ·è¡ŒçµæœæŒ‡æ´¾çµ¦ `list`
```shell
list=`cat "$1"`
```

å¦‚ä¸‹æŒ‡ä»¤åœ¨ `$list` å‰å¾Œçš„`"`ç”¨ä»¥ç¢ºä¿æ›è¡Œå­—å…ƒæœƒè¢«ä¿ç•™ä¸‹ä¾†ã€‚
```shell
echo "$list" | ... 
```

å‰›å‰›æƒ³åˆ°ï¼Œè‹¥`$list`åªæœƒè¢«ç”¨åˆ°ä¸€æ¬¡ï¼Œå…¶å¯¦ä¹Ÿå¯ä»¥åˆªå»`` list=`cat "$1"` ``æŒ‡ä»¤ï¼Œç„¶å¾Œå°‡ä¸Šé¢çš„æŒ‡ä»¤æ”¹ç‚ºå¦‚ä¸‹ï¼š
```shell
cat "$1" | ...
```

å¦‚ä¸‹æŒ‡ä»¤æ˜¯ç‚ºäº†è®€å– diskutil è¼¸å‡ºå…§å®¹çš„ç¬¬ 1 å€‹æ¬„ä½ï¼Œå°‡å…¶å€¼æŒ‡æ´¾åˆ°`x1`ï¼Œå› ç‚ºå…¶ä»–æ¬„ä½éƒ½ä¸é‡è¦ï¼Œå°±æŒ‡æ´¾åˆ° `z`ã€‚
```shell
read x1 z
```

å¦‚ä¸‹æŒ‡ä»¤çš„`\"`æ˜¯ç‚ºäº†ä¿ç•™`"` ï¼Œå¦‚æ­¤ç”¢ç”Ÿçš„å¤–æ®¼è…³æœ¬æ‰èƒ½ä¿æœ‰å­—ä¸²å‰å¾Œçš„`"`ï¼Œå› ç‚ºæœ‰äº›å­—ä¸²ä¸­æœ‰ç©ºç™½ï¼Œé€éå‰å¾Œçš„`"`ä¾†ç¢ºä¿å®Œæ•´çš„å­—ä¸²æœƒè¢«ç•¶æˆä¸€å€‹å­—ä¸²è™•ç†ã€‚åŠ ä¸Š`force`åƒæ•¸çš„ç›®çš„å‰‡æ˜¯ç‚ºäº†å¼·åˆ¶å¸è¼‰å·å†Šã€‚
```shell
 echo diskutil unmount force \"/Volumes/$m\"
```

åœ¨è…³æœ¬æœ€å¾Œåšäº†å¹¾ä»¶äº‹ï¼ŒåŒ…æ‹¬ï¼š
- `touch \"/Volumes/$m/.metadata_never_index\"` é€™æ˜¯ç”¨ä¾†é¿å…å§†æŒ‡ç¢Ÿåœ¨å…¶ä»– macOS ä¸Šæ›è¼‰å¾Œ Spotlight å°æ­¤ä¸€å·å†Šé€²è¡Œç´¢å¼•ã€‚
- å¸è¼‰åç‚ºã€ŒShared Supportã€çš„å·å†ŠåŠé€€å‡ºç£ç¢Ÿæ˜ åƒæª”æ¡ˆã€‚ é€™æ˜¯å› ç‚º macOS Big Sur ä¹‹å¾Œè£½ä½œå®‰è£å·å†Šçš„éç¨‹æœƒæ›è¼‰åç‚ºã€ŒShared Supportã€çš„å·å†Šã€‚

æª¢è¦–ç”¢ç”ŸæŒ‡ä»¤çš„å¤–æ®¼è…³æœ¬
```shell
more bin/MakeMacOSInstallers
```
```shell
:
[ -z "$1" ] && exit

list=`cat "$1"`

XFS=$IFS
IFS=","
echo "$list" | grep -v Pod | while read v s
do
        l=`echo "For $v"`
        m="Install macOS $v"
        echo \"/Applications/$m.app/Contents/Resources/createinstallmedia\" --volume \"/Volumes/$l\" --nointeraction
        echo touch \"/Volumes/$m/.metadata_never_index\"
        echo sync
        echo sleep 60
cat << EOF
df | grep "Shared Support" | while read x1 x2 x3 x4 x5 x6 x7 x8 x9
do
        diskutil unmount force "\$x9"
done

diskutil list external virtual | grep "(disk image)" | while read x1 z
do
        diskutil eject "\$x1"
done
EOF
        echo diskutil unmount force \"/Volumes/$m\"
done
IFS=$XFS
```

æª¢è¦–å°‡åŸ·è¡Œçš„æŒ‡ä»¤
```shell
bin/MakeMacOSInstallers etc/USBPartitionTable.txt
```
```shell
"/Applications/Install macOS High Sierra.app/Contents/Resources/createinstallmedia" --volume "/Volumes/For High Sierra" --nointeraction
touch "/Volumes/Install macOS High Sierra/.metadata_never_index"
sync
sleep 60
df | grep "Shared Support" | while read x1 x2 x3 x4 x5 x6 x7 x8 x9
do
	diskutil unmount force "$x9"
done

diskutil list external virtual | grep "(disk image)" | while read x1 z
do
	diskutil eject "$x1"
done
...(å…¶é¤˜çœç•¥)
```

### bin/MountUSBVolumes

æ­¤ä¸€å¤–æ®¼è…³æœ¬ç”¨ä¾†æ›è¼‰å§†æŒ‡ç¢Ÿä¸Šçš„æ‰€æœ‰å·å†Šã€‚nl æŒ‡ä»¤ç”¨æ–¼å°‡è¼¸å…¥çš„åˆ†å‰²å€é…ç½®è³‡æ–™åŠ ä¸Šè¡Œè™Ÿï¼Œé€éè¡Œè™Ÿä¾†é…åˆåˆ‡ç‰‡(slice)çš„ç·¨è™Ÿï¼Œè—‰æ­¤å°æ‡‰åˆ°æ­£ç¢ºçš„è£ç½®æª”æ¡ˆã€‚é—œæ–¼ nl çš„åƒæ•¸ï¼Œå¯ä»¥é€é man nl æŒ‡ä»¤äº†è§£å…¶æ„ç¾©ã€‚

æª¢è¦–ç”¢ç”ŸæŒ‡ä»¤çš„å¤–æ®¼è…³æœ¬
```shell
more bin/MountUSBVolumes
```
```shell
:
[ -z "$2" ] && exit

list=`cat "$2"`

XFS=$IFS
IFS=","
echo "$list" | nl -s, -v 2 -ba -n ln -w 1 | while read n v s
do
        echo diskutil mount \"$1s$n\"
done
IFS=$XFS
```

æª¢è¦–å°‡åŸ·è¡Œçš„æŒ‡ä»¤
```shell
bin/MountUSBVolumes disk2 etc/USBPartitionTable.txt
```
```shell
diskutil mount "disk2s2"
diskutil mount "disk2s3"
diskutil mount "disk2s4"
diskutil mount "disk2s5"
diskutil mount "disk2s6"
diskutil mount "disk2s7"
diskutil mount "disk2s8"
```

### bin/PartitionUSBFlashDrive

æ­¤ä¸€å¤–æ®¼è…³æœ¬ç”¨ä¾†ç”¢ç”Ÿåˆ†å‰²å§†æŒ‡ç¢Ÿä¸Šçš„æŒ‡ä»¤ã€‚

æª¢è¦–ç”¢ç”ŸæŒ‡ä»¤çš„å¤–æ®¼è…³æœ¬
```shell
more bin/PartitionUSBFlashDrive
```
```shell
:
[ -z "$2" ] && exit

list=`cat "$2"`

XFS=$IFS
IFS=","
parameters=`echo "$list" | while read v s
do
        echo JHFS+
        if [ "$v" = "Pod" ]
        then
                echo \"$v\"
        else
                echo \"For $v\"
        fi
        echo $s
done`
IFS=$XFS

x=`echo "$list" | wc -l`
echo diskutil partitionDisk $1 $x $parameters
```

æª¢è¦–å°‡åŸ·è¡Œçš„æŒ‡ä»¤
```shell
bin/PartitionUSBFlashDrive disk2 etc/USBPartitionTable.txt
```
```shell
diskutil partitionDisk disk2 7 JHFS+ "For High Sierra" 8GB JHFS+ "For Mojave" 8GB JHFS+ "For Catalina" 10GB JHFS+ "For Big Sur" 14GB JHFS+ "For Monterey" 16GB JHFS+ "For Ventura" 16GB JHFS+ "Pod" R
```

### bin/RenameUSBVolumes

æ­¤ä¸€å¤–æ®¼è…³æœ¬ç”¨ä¾†å°‡å§†æŒ‡ç¢Ÿä¸Šçš„æ‰€æœ‰å·å†Šæ›´åå›å‰›åˆ†å‰²å¾Œçš„åç¨±ï¼Œå¦‚æ­¤ä¸ç”¨é‡æ–°åˆ†å‰²å°±å¯ä»¥é‡æ–°è£½ä½œå„ç‰ˆæœ¬çš„ macOS å®‰è£å·å†Šã€‚

æª¢è¦–ç”¢ç”ŸæŒ‡ä»¤çš„å¤–æ®¼è…³æœ¬
```shell
more bin/RenameUSBVolumes
```
```shell
:
[ -z "$2" ] && exit

list=`cat "$2"`

XFS=$IFS
IFS=","
echo "$list" | nl -s, -v 2 -ba -n ln -w 1 | while read n v s
do
        if [ "$v" = "Pod" ]
        then
                l="$v"
        else
                l="For $v"
        fi
        echo diskutil rename \"$1s$n\" \"$l\"
done
IFS=$XFS
```

æª¢è¦–å°‡åŸ·è¡Œçš„æŒ‡ä»¤
```shell
bin/RenameUSBVolumes disk2 etc/USBPartitionTable.txt
```
```shell
diskutil rename "disk2s2" "For High Sierra"
diskutil rename "disk2s3" "For Mojave"
diskutil rename "disk2s4" "For Catalina"
diskutil rename "disk2s5" "For Big Sur"
diskutil rename "disk2s6" "For Monterey"
diskutil rename "disk2s7" "For Ventura"
diskutil rename "disk2s8" "Pod"
```

### bin/UnmountUSBVolumes

æ­¤ä¸€å¤–æ®¼è…³æœ¬ç”¨ä¾†å¸è¼‰å§†æŒ‡ç¢Ÿä¸Šçš„æ‰€æœ‰å·å†Šã€‚

æª¢è¦–ç”¢ç”ŸæŒ‡ä»¤çš„å¤–æ®¼è…³æœ¬
```shell
more bin/UnmountUSBVolumes
```
```shell
:
[ -z "$1" ] && exit

df | grep "$1[^0-9]" | sort | while read x1 x2 x3 x4 x5 x6 x7 x8 x9
do
        m=$x9
        echo diskutil unmount force \"$m\"
done
```

æª¢è¦–å°‡åŸ·è¡Œçš„æŒ‡ä»¤
```shell
bin/UnmountUSBVolumes disk2
```
```shell
diskutil unmount force "/Volumes/Install macOS High Sierra"
...ï¼ˆç•¥ï¼‰
diskutil unmount force "/Volumes/Pod"
```

## å¹•å¾ŒèŠ±çµ®

### éŒ¯èª¤è¨Šæ¯ -69888
```text
Erasing Disk: 0%... 10%...
Error erasing disk error number (-69888, 0)
A error occurred erasing the disk.
```
è‹¥å‡ºç¾å¦‚ä¸Šçš„éŒ¯èª¤è¨Šæ¯ï¼Œæˆ–è¨±å¯ä»¥ç”¨ `ls /Volumes`çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰åŒåçš„å·å†Šã€‚

### é–‹æ©Ÿç•«é¢

ç‚ºäº†æˆªå–é–‹æ©Ÿç•«é¢ï¼Œæœ¬ä¾†æ˜¯ç”¨æ‰‹æ©Ÿæ‹ç…§ï¼Œå¾Œä¾†æ˜¯æ¥äº†å¤–æ¥ USB éµç›¤ä¸¦ä»¥ HDMI è¼¸å‡ºæ¥åˆ°å½±åƒæ“·å–å¡é€é OBS ä¾†æˆªåœ–ã€‚

## åƒè€ƒè³‡æ–™

### æ–‡ä»¶ç›®æ¨™

- [é–‹æ©Ÿçµ„åˆéµ - Apple æ”¯æ´ (å°ç£)](https://support.apple.com/zh-tw/102603)
- [å¦‚æœ Mac æ²’æœ‰é †æš¢åœ°å®Œæˆå•Ÿå‹• - Apple æ”¯æ´ (å°ç£)](https://support.apple.com/zh-tw/HT204156)
- [Fix MacBook Error 5101F With This Quick Guide - AppleToolBox](https://appletoolbox.com/fix-macbook-error-5101f/)
- [GitHub - MuertoGB/MacBRTool: ğŸ’» MacBRTool is used to update Mac BootROM firmware in EFI mode, adding APFS support.](https://github.com/MuertoGB/MacBRTool)
- [How to create a macOS 13 Ventura installer on a USB drive](https://www.idownloadblog.com/2022/06/10/how-to-create-bootable-usb-installer-macos-ventura/)

### æº–å‚™å·¥ä½œ
- [MacOS Sierra: Enable/Disable Spotlight Indexing - Technipages](https://www.technipages.com/macos-sierra-enable-disable-spotlight/)
- [macos - Preventing Spotlight from Indexing Files & Folders? - Ask Different](https://apple.stackexchange.com/questions/92784/preventing-spotlight-from-indexing-files-folders)

### å…¶ä»–è³‡æ–™

- [Apple Regulatory Information](https://regulatoryinfo.apple.com/tw/rfexposure)
- [macOS version history - Wikipedia](https://en.wikipedia.org/wiki/MacOS_version_history)
- [è¾¨è­˜ MacBook Pro æ©Ÿå‹ - Apple æ”¯æ´ (å°ç£)](https://support.apple.com/zh-tw/HT201300)
- [Mac OS Compatibility Guide by Mac Model](https://eshop.macsales.com/guides/Mac_OS_X_Compatibility)
- [How to find out macOS version using terminal command - nixCraft](https://www.cyberciti.biz/faq/mac-osx-find-tell-operating-system-version-from-bash-prompt/)
- [è‹¥ç„¡æ³•åœ¨å¤–æ¥é¡¯ç¤ºå™¨ä¸Šçœ‹è¦‹ Mac æ¡Œé¢ - Apple æ”¯æ´ (å°ç£)](https://support.apple.com/zh-tw/guide/mac-help/mchlp2615/10.13/mac/10.13)
